<!DOCTYPE html>
<html lang="en">
    <head>
    	<title>Mars Rover</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        
	</head>
	<body>

		<style>

			.command-panel, .data-panel {
				width: 500px;
				margin: 0 auto;
				text-align: center;
				border: 1px solid gray;
				padding: 40px;
				border-radius: 2px;
				margin-top: 30px;
			}

			span {
				letter-spacing: 2px;
			}
		</style>

		<div class="command-panel">
			<h2>Send commands</h2>
			<input type="file" name="data" id="data">
		</div>

		<div class="data-panel" id=data-panel>
		</div>
		


		<script src="mars-rover.js"></script>
		<script>

			// Create new rover object
			rover = new MarsRover();
			rover.ID = 1;


			// Element selectors
			const dataPanel = document.querySelector('#data-panel');
			const commandFile = document.querySelector('input[type="file"]');

			// Append rover's position to HTML.
			let position = document.createElement('h4');
			// position.innerHTML = `Rover ${rover.ID} is currently at position: ${rover.position}`;
			// dataPanel.appendChild(position);


			/**
			 * Send commands to the rover.
			 */
			function setCommands() {

				let file = this.files[0],
		        reader = new FileReader();
		       

		        reader.onload = function(progressEvent) {

		            // Split each line
		            let lines = this.result.split('\n');

		            rover.readFile(lines);

	
					
					
					// console.log(combine);
					// var newArray = [];

				  	// For every combination of a rover and its command, create a new rover object
					// for (var k in combine) {	
					// 	// Create a new rover object
					//     var obj = new MarsRover(combine[k], combine[k][4], rover.plateau);
					//     newArray.push(obj);
					//     // And assign values
					//     obj.position = combine[k];
					//     obj.commands = k;
					//     obj.location = [parseInt(combine[k][0]), parseInt(combine[k][2])];
					//     // Increment each object ID
					//     newArray.forEach(combination => obj.ID++); 

					//     console.log(obj);
					// }

					// console.log(newArray);
				    // For every new object in the objects array, call the navigate function
				    // for (var ob in newArray) {
				    	// for(i = 0; i < newArray[ob].commands.length; i++) {
				    	// 	rover.navigate(newArray[ob].commands.toString().toLowerCase());
				    	// }
				    	// Call the navigate function with the txt file command lines
	            		// rover.navigate(newArray[ob].commands.toString().toLowerCase());
	            		// console.log(obj);					    
	            	// }

					// for (var i = 0; i < newArray.length; i++) {
					//     o = newArray[i];

					//  //    for (var p in o) {
					// 	//     if (o.hasOwnProperty(p) && o.ID == 3) {
					// 	//     	console.log(o)
					// 	//         return o;
					// 	//     }
					// 	// }
					// }

					// Reset file upload field to clear value for new one
		            commandFile.value = null;

		        };

		        reader.readAsText(file);
			}


			// Listener for file upload
			commandFile.addEventListener('change', setCommands);

		</script>
	</body>
</html>